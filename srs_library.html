<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ø§Ù„Ù…ÙƒØªØ¨Ø© - Ø§Ù„Ø°Ø§ÙƒØ±Ø© PRO</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        tailwind.config = { darkMode: 'class', theme: { extend: { fontFamily: { sans: ['Tajawal', 'sans-serif'] }, colors: { brand: { DEFAULT: '#2563eb', dark: '#1d4ed8' }, dark: { bg: '#0f172a', card: '#1e293b', sidebar: '#111827' } }, padding: { 'safe': 'env(safe-area-inset-bottom)' } } } }
    </script>
    <style>body { -webkit-tap-highlight-color: transparent; }</style>
</head>
<body class="bg-slate-50 dark:bg-dark-bg text-slate-800 font-sans transition-colors duration-300 pb-24 md:pb-0">

    <aside class="hidden md:flex fixed top-0 right-0 h-full w-64 bg-white dark:bg-dark-sidebar border-l border-gray-200 dark:border-gray-700 z-50 flex-col p-6 shadow-xl">
        <div class="flex items-center gap-3 mb-10">
            <div class="w-10 h-10 bg-brand rounded-xl flex items-center justify-center text-white shadow-lg shadow-brand/40"><i class="fas fa-brain text-xl"></i></div>
            <h1 class="font-black text-xl dark:text-white">Ø§Ù„Ø°Ø§ÙƒØ±Ø© <span class="text-brand">PRO</span></h1>
        </div>
        <nav class="space-y-2 flex-1">
            <a href="srs_index.html" class="flex items-center gap-3 px-4 py-3 rounded-xl text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-800 transition"><i class="fas fa-home w-6"></i> Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø©</a>
            <a href="srs_schedule.html" class="flex items-center gap-3 px-4 py-3 rounded-xl text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-800 transition"><i class="far fa-calendar-alt w-6"></i> Ø§Ù„Ø¬Ø¯ÙˆÙ„</a>
            <a href="srs_library.html" class="flex items-center gap-3 px-4 py-3 rounded-xl bg-brand/10 text-brand font-bold transition"><i class="fas fa-layer-group w-6"></i> Ø§Ù„Ù…ÙƒØªØ¨Ø©</a>
            <a href="srs_stats.html" class="flex items-center gap-3 px-4 py-3 rounded-xl text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-800 transition"><i class="fas fa-chart-pie w-6"></i> Ø§Ù„ØªØ­Ù„ÙŠÙ„</a>
            <div class="my-4 border-t border-gray-100 dark:border-gray-700"></div>
            <a href="srs_settings.html" class="flex items-center gap-3 px-4 py-3 rounded-xl text-gray-500 hover:bg-gray-50 dark:hover:bg-slate-800 transition"><i class="fas fa-cog w-6"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</a>
        </nav>
    </aside>

    <main class="md:mr-64 min-h-screen p-4 md:p-8">
        <header class="mb-8">
            <h1 class="text-3xl font-black text-slate-800 dark:text-white mb-2">Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù…Ù†Ø§Ù‡Ø¬ ğŸ“š</h1>
            <p class="text-gray-500 dark:text-gray-400">Ø§Ø³ØªÙˆØ±Ø¯ Ù…Ù†Ø§Ù‡Ø¬ Ø¬Ø§Ù‡Ø²Ø© ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„Ø¯Ø±Ø§Ø³Ø© ÙÙˆØ±Ø§Ù‹.</p>
        </header>

        <div id="libraryContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            </div>
    </main>

    <nav class="md:hidden fixed bottom-0 left-0 right-0 bg-white dark:bg-dark-card border-t border-gray-200 dark:border-gray-700 pb-safe z-50 flex justify-around items-center h-16 shadow-[0_-5px_15px_rgba(0,0,0,0.05)]">
        <a href="srs_index.html" class="flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-brand dark:hover:text-blue-400 transition"><i class="fas fa-home text-xl mb-1"></i><span class="text-[10px] font-bold">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span></a>
        <a href="srs_schedule.html" class="flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-brand dark:hover:text-blue-400 transition"><i class="far fa-calendar-alt text-xl mb-1"></i><span class="text-[10px] font-bold">Ø§Ù„Ø¬Ø¯ÙˆÙ„</span></a>
        <a href="srs_library.html" class="flex flex-col items-center justify-center w-full h-full text-brand dark:text-blue-400 transition"><i class="fas fa-layer-group text-xl mb-1"></i><span class="text-[10px] font-bold">Ø§Ù„Ù…ÙƒØªØ¨Ø©</span></a>
        <a href="srs_stats.html" class="flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-brand dark:hover:text-blue-400 transition"><i class="fas fa-chart-pie text-xl mb-1"></i><span class="text-[10px] font-bold">ØªØ­Ù„ÙŠÙ„</span></a>
        <a href="srs_settings.html" class="flex flex-col items-center justify-center w-full h-full text-gray-400 hover:text-brand dark:hover:text-blue-400 transition"><i class="fas fa-cog text-xl mb-1"></i><span class="text-[10px] font-bold">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span></a>
    </nav>

    <script>
        const REPO_KEY = 'srs_repo_content_v1';
        const DB_KEY = 'srs_pro_db_v1';
        const SETTINGS_KEY = 'srs_pro_settings_v1';
        
        let repoData = [];

        function init() {
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
            const s = localStorage.getItem(SETTINGS_KEY);
            if(s && JSON.parse(s).darkMode) document.documentElement.classList.add('dark');

            // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙƒØªØ¨Ø© (Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙØ§Ø±ØºØ©)
            const storedRepo = localStorage.getItem(REPO_KEY);
            if (storedRepo) {
                repoData = JSON.parse(storedRepo);
            } else {
                // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª
                repoData = [
                    {
                        id: 1,
                        title: "Ø·Ø¨ Ø¨Ø´Ø±ÙŠ - Ø³Ù†Ø© Ø£ÙˆÙ„Ù‰",
                        desc: "ØªØ´Ø±ÙŠØ­ØŒ Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§ØŒ ÙÙŠØ²ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§ (Ø¯Ø±ÙˆØ³ Ø§Ù„ÙØµÙ„ Ø§Ù„Ø£ÙˆÙ„)",
                        color: "bg-blue-500",
                        icon: "fa-user-md",
                        subjects: [
                            { name: "ØªØ´Ø±ÙŠØ­", lessons: ["Ø¹Ø¸Ø§Ù… Ø§Ù„Ø¬Ù…Ø¬Ù…Ø©", "Ø§Ù„Ù‚ÙØµ Ø§Ù„ØµØ¯Ø±ÙŠ", "Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„ÙÙ‚Ø±ÙŠ", "Ø¹Ø¶Ù„Ø§Øª Ø§Ù„ÙˆØ¬Ù‡"] },
                            { name: "Ø¨ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§", lessons: ["Ø§Ù„Ø®Ù„ÙŠØ© Ø§Ù„Ø­ÙŠÙˆØ§Ù†ÙŠØ©", "Ø§Ù„Ø§Ù†Ù‚Ø³Ø§Ù… Ø§Ù„Ù…Ù†ØµÙ", "DNA & RNA"] },
                            { name: "ÙÙŠØ²ÙŠÙˆÙ„ÙˆØ¬ÙŠØ§", lessons: ["Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ø¹ØµØ¨ÙŠ", "Ø¬Ù‡Ø¯ Ø§Ù„ÙØ¹Ù„", "Ù†Ù‚Ù„ Ø§Ù„Ø³ÙŠØ§Ù„Ø© Ø§Ù„Ø¹ØµØ¨ÙŠØ©", "Ø§Ù„Ù‡Ø±Ù…ÙˆÙ†Ø§Øª"] }
                        ]
                    },
                    {
                        id: 2,
                        title: "Ø¨ÙƒØ§Ù„ÙˆØ±ÙŠØ§ - Ø¹Ù„ÙˆÙ… ØªØ¬Ø±ÙŠØ¨ÙŠØ©",
                        desc: "Ø£Ù‡Ù… Ø§Ù„ÙˆØ­Ø¯Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ù„ÙˆÙ… ÙˆØ§Ù„ÙÙŠØ²ÙŠØ§Ø¡",
                        color: "bg-green-500",
                        icon: "fa-flask",
                        subjects: [
                            { name: "Ø¹Ù„ÙˆÙ… Ø·Ø¨ÙŠØ¹ÙŠØ©", lessons: ["ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†", "Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ø¨Ù†ÙŠØ© ÙˆØ§Ù„ÙˆØ¸ÙŠÙØ©", "Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø¥Ù†Ø²ÙŠÙ…ÙŠ", "Ø§Ù„Ù…Ù†Ø§Ø¹Ø©"] },
                            { name: "ÙÙŠØ²ÙŠØ§Ø¡", lessons: ["Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø²Ù…Ù†ÙŠØ© Ù„ØªØ­ÙˆÙ„ ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ", "Ø§Ù„ØªØ­ÙˆÙ„Ø§Øª Ø§Ù„Ù†ÙˆÙˆÙŠØ©", "Ø§Ù„Ø¸ÙˆØ§Ù‡Ø± Ø§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ©"] }
                        ]
                    },
                    {
                        id: 3,
                        title: "Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© - Ù…Ø³ØªÙˆÙ‰ B1",
                        desc: "Ù‚ÙˆØ§Ø¹Ø¯ ÙˆÙ…ÙØ±Ø¯Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„Ù…Ø­Ø§Ø¯Ø«Ø©",
                        color: "bg-purple-500",
                        icon: "fa-language",
                        subjects: [
                            { name: "Grammar", lessons: ["Present Perfect", "Past Continuous", "Conditionals", "Passive Voice"] },
                            { name: "Vocabulary", lessons: ["Travel & Transport", "Work & Careers", "Feelings & Emotions"] }
                        ]
                    }
                ];
                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„ÙŠØ³ØªØ·ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠØ± ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹
                localStorage.setItem(REPO_KEY, JSON.stringify(repoData));
            }

            renderLibrary();
        }

        function renderLibrary() {
            const container = document.getElementById('libraryContainer');
            container.innerHTML = repoData.map(item => {
                // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø±ÙˆØ³ ÙˆØ§Ù„Ù…ÙˆØ§Ø¯
                let lessonCount = 0;
                let subjectCount = item.subjects.length;
                item.subjects.forEach(sub => lessonCount += sub.lessons.length);

                return `
                <div class="bg-white dark:bg-dark-card rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden hover:shadow-lg transition flex flex-col h-full">
                    <div class="h-32 ${item.color} relative p-6 flex flex-col justify-between">
                        <div class="w-12 h-12 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center text-white text-2xl shadow-inner">
                            <i class="fas ${item.icon}"></i>
                        </div>
                        <h3 class="text-white font-black text-xl drop-shadow-md leading-tight">${item.title}</h3>
                    </div>
                    <div class="p-6 flex-1 flex flex-col">
                        <p class="text-gray-500 text-sm mb-4 flex-1">${item.desc}</p>
                        
                        <div class="flex items-center gap-4 text-xs font-bold text-gray-400 mb-6">
                            <span class="bg-gray-100 dark:bg-slate-800 px-3 py-1 rounded-full"><i class="fas fa-book ml-1"></i> ${subjectCount} Ù…ÙˆØ§Ø¯</span>
                            <span class="bg-gray-100 dark:bg-slate-800 px-3 py-1 rounded-full"><i class="fas fa-list-ul ml-1"></i> ${lessonCount} Ø¯Ø±Ø³</span>
                        </div>

                        <button onclick="importCourse(${item.id})" class="w-full py-3 bg-brand/10 text-brand font-bold rounded-xl hover:bg-brand hover:text-white transition active:scale-95 flex items-center justify-center gap-2">
                            <i class="fas fa-download"></i> Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù„Ù„Ù…ÙƒØªØ¨Ø©
                        </button>
                    </div>
                </div>
                `;
            }).join('');
        }

        function importCourse(id) {
            const course = repoData.find(c => c.id === id);
            if (!course) return;

            Swal.fire({
                title: 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯',
                text: `Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ù‡Ø¬ "${course.title}" Ø¥Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ÙƒØŸ`,
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø£Ø¶Ù Ø§Ù„Ø¯Ø±ÙˆØ³',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡'
            }).then((result) => {
                if (result.isConfirmed) {
                    // Ø¬Ù„Ø¨ Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                    let userDB = JSON.parse(localStorage.getItem(DB_KEY)) || { lessons: [], user: {} };
                    
                    let addedCount = 0;
                    const now = new Date();
                    const next = new Date(); next.setDate(now.getDate() + 1); // Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© ØºØ¯Ø§Ù‹

                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø±ÙˆØ³
                    course.subjects.forEach(sub => {
                        sub.lessons.forEach(lessonTitle => {
                            userDB.lessons.push({
                                id: Date.now() + Math.random(),
                                subject: sub.name,
                                title: lessonTitle,
                                layer: 0,
                                nextReview: next.toISOString(),
                                lastReview: now.toISOString(),
                                easeFactor: 2.5
                            });
                            addedCount++;
                        });
                    });

                    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                    localStorage.setItem(DB_KEY, JSON.stringify(userDB));

                    Swal.fire({
                        title: 'ØªÙ… Ø¨Ù†Ø¬Ø§Ø­! ğŸ‰',
                        text: `ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© ${addedCount} Ø¯Ø±Ø³Ø§Ù‹ Ø¥Ù„Ù‰ Ø¬Ø¯ÙˆÙ„Ùƒ.`,
                        icon: 'success'
                    });
                }
            });
        }

        init();
    </script>
</body>
</html>